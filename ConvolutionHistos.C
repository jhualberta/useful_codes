{
  //For WLS study
  gROOT->Reset();
  //gStyle->SetOptStat(0);
  TFile *f = new TFile("WLS_process_5MeV.root");
  TH1F *hTimeDiff = (TH1F*)f->Get("timeDiff");
  hTimeDiff->SetTitle("Time distribution for Cerenkov photon getting absorbed and reemitted");
  TH1F *hCerenkovAngle = (TH1F*)f->Get("CerenkovAngle");

/*  nhit->GetXaxis()->SetRange(0,70);
  nhit->GetXaxis()->SetTitle("Nhits");
  TH1F *nhitG=(TH1F*)f->Get("NHitsGamma");
  nhitG->GetXaxis()->SetRange(0,70);
  nhitG->GetXaxis()->SetTitle("Nhits");
  TH1F *nhitP=(TH1F*)f->Get("NHitsPositron");
  nhitP->GetXaxis()->SetRange(0,70);
  nhitP->GetXaxis()->SetTitle("Nhits");
*/

 double arrayPDF[1600] ={230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 230.313, 269.038, 250.695, 248.656, 246.618, 279.229, 256.809, 250.695, 330.183, 285.343, 315.916, 299.611, 428.015, 409.672, 432.091, 523.809, 544.191, 556.42, 572.725, 658.328, 674.633, 660.366, 697.053, 717.435, 766.351, 762.274, 701.129, 688.9, 666.481, 664.442, 717.435, 603.297, 623.679, 540.114, 519.733, 515.656, 493.236, 478.969, 452.473, 452.473, 377.061, 346.488, 346.488, 379.099, 299.611, 346.488, 313.878, 334.259, 287.382, 342.412, 264.962, 256.809, 264.962, 256.809, 269.038, 307.763, 277.191, 258.847, 246.618, 260.885, 232.351, 319.992, 356.679, 354.641, 466.74, 662.404, 919.213, 1385.95, 2080.97, 3183.62, 4981.28, 7592.17, 11350.6, 17126.7, 25511.7, 37610.3, 56163.7, 81681.6, 116824, 167674, 235084, 323999, 439779, 583857, 762490, 974083, 1.21593e+06, 1.49125e+06, 1.78256e+06, 2.0891e+06, 2.39494e+06, 2.6873e+06, 2.95026e+06, 3.16819e+06, 3.33574e+06, 3.4329e+06, 3.46683e+06, 3.43715e+06, 3.33696e+06, 3.17906e+06, 2.98439e+06, 2.75216e+06, 2.50735e+06, 2.24666e+06, 1.99678e+06, 1.75412e+06, 1.52577e+06, 1.32052e+06, 1.13063e+06, 967157, 824563, 702532, 595422, 506120, 428934, 365244, 310884, 263780, 225760, 193703, 167338, 144740, 124913, 109723, 96014, 85389, 76386.4, 69780.7, 63042.5, 57688.3, 54641.2, 51592.1, 48838.6, 47055.2, 46001.4, 45312.5, 45015, 44550.2, 44786.7, 44489.1, 44073.3, 43867.5, 43488.4, 43260.1, 42133, 41403.3, 40494.3, 39803.4, 38719.1, 37072.2, 35879.9, 34408.3, 32810.4, 32068.5, 29879.5, 28838, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3,27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3,  27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3, 27837.3 } ; 

  TH1F *hPDF = new TH1F("hPDF","PMTresponse PDF",1600,-100,300);
  TCanvas *c1 = new TCanvas();
  c1->Divide(2,2) ;
  
  c1->cd(1);
  hTimeDiff->Draw();
  c1->cd(2);
  
  for(int i=0; i< 1600; i++ ){ hPDF->SetBinContent(i,arrayPDF[i]) ; }
  
  hPDF->Draw();
  c1->cd(3);
  
  int nBinsH1=1600;
  int nBinsH2=1600 ;
  int nBinstemp = nBinsH1+nBinsH2-1;

  double binWidth =1.0;

  TH1D temp("TEMP","temp",nBinstemp,0,(double)nBinstemp*binWidth);
  
  TH1D tempG("TEMPG","tempG",nBinstemp,0,(double)nBinstemp*binWidth);

  TH1D tempP("TEMPP","tempP",nBinstemp,0,(double)nBinstemp*binWidth);

  TH1D *hConvl = new TH1D("hConvl","Colvoluted distribution",1600,1,1600) ;

  //gPad->SetGrid();
  /*
  TH1F *f1=new TH1F("f1","PulseGT poissionian distribution with mean 2.0 nhits",500,1,100);

  TH1F *f2=new TH1F("f2","convoluted distribution with gamma nhits",100,1,100);
  TH1F *f2P=new TH1F("f2P","convoluted distribution with positron nhits",100,1,100);
  TH1F *f22=new TH1F("f22","convoluted distribution with antineutrino and gamma nhits",100,1,100);

  TH1F *f3=new TH1F("f3","PulseGT Trigger rate",100,1,100);
    
  for(int i=0; i< nBinsH1 ; i++){ double funV= 2.0**i*TMath::Exp(-2.0)/TMath::Factorial(i); f1->SetBinContent(i,funV);}

  for(int b=0; b< nBinsH1 ; b++){ double bincont = 1e7*(f1->GetBinContent(b)); f3->SetBinContent(b,bincont);}

  f1->SetLineColor(kRed);
  f1->GetXaxis()->SetRange(0,70);
  f1->GetXaxis()->SetTitle("Nhits");
  f1->Draw();

  c1->cd(3);
 
  gPad-> SetLogy();
   
  f3->GetXaxis()->SetRange(0,70);
  f3->GetXaxis()->SetTitle("Nhits");
  f3->GetYaxis()->SetTitle("Trigger Rate");
  f3->SetLineColor(kBlack);
  gPad->SetGrid();
  f3->Draw();

  c1->cd(4);
  */

  for(int j=1; j<=nBinsH1; j++){
    double val = hPDF->GetBinContent(j);
    for(int k=1; k<= nBinsH2; k++)
      {
	double convVal = hTimeDiff->GetBinContent(k) ;
	double t= tempG->GetBinContent(j+k-1);
	tempG->SetBinContent(j+k-1,t+val*convVal);
      }

  }

  for(int m=1; m<=nBinsH1; m++) {
    hConvl->SetBinContent(m,tempG->GetBinContent(m));
  }

  hConvl->Draw() ;

 // std::cout<< " sPDF_WLSFit : [ "<<std::endl ;
 
  for(int k=1; k< nBinsH1; k++) std::cout << hConvl->GetBinContent(k)<<", " ;
  //std::cout << std::endl ;
 
  c1->cd(4);

  hCerenkovAngle->Draw() ;
  std::cout <<" hCerenkovAngle->GetNbinsX() "<< hCerenkovAngle->GetNbinsX() << std::endl ;

 for(int kk=1; kk< hCerenkovAngle->GetNbinsX(); kk++) std::cout << hCerenkovAngle->GetBinContent(kk)<<", " ;

  std::cout<<std::endl ;
  
/*  f2->GetXaxis()->SetRange(0,70);
  f2->GetXaxis()->SetTitle("Nhits");
  f2->SetLineColor(kBlue);
  gPad->SetGrid();
  f2->Draw();

  c1->cd(5);

  for(int pj=1; pj<=nBinsH1; pj++){
    double valP = f1->GetBinContent(pj);
    for(int pk=1; pk<= nBinsH2; pk++)
      {
	double convVal = nhitP->GetBinContent(pk) ;
	double t= tempP->GetBinContent(pj+pk-1);
	tempP->SetBinContent(pj+pk-1,t+valP*convVal);
      }

  }

  for(int mp=1;mp<=100; mp++){
    f2P->SetBinContent(mp,tempP->GetBinContent(mp));
  }


  f2P->GetXaxis()->SetRange(0,70);
  f2P->GetXaxis()->SetTitle("Nhits");
  f2P->SetLineColor(kBlue);
  gPad->SetGrid();
  f2P->Draw();
 */
  /*  
  for(int jj=1; jj<=nBinsH1; jj++){
    double valG = f2->GetBinContent(jj);
    for(int kk=1; kk<= nBinsH2; kk++)
      {
	double convValG= nhit->GetBinContent(kk) ;
	double tG= temp->GetBinContent(jj+kk-1);
	temp->SetBinContent(jj+kk-1,tG+valG*convValG);
      }

  }


  for(int m=1;m<=100; m++){
    f22->SetBinContent(m,temp->GetBinContent(m));
  }

  f22->GetXaxis()->SetRange(0,70);
  f22->GetXaxis()->SetTitle("Nhits");
  f22->SetLineColor(kBlue);
  gPad->SetGrid();
  f22->Draw();
  
  
  Int_t biniG = nhitG->FindBin(12);
  Int_t binfG = nhitG->FindBin(70);
  Double_t integNhit = nhitG->Integral(biniG,binfG);
  cout<<" Integral of nhits above threshold in NHitG "<<integNhit<<endl ;
  */
}
