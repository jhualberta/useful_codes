{
  gSystem->Load("libMathMore");

//  double evt0[]={1.69682, 1.7269,1.70283, 1.47985,1.71798, 2.03559,2.1626, 1.3209,2.42584, 1.60911,1.96946, 2.61187,-2.86372, 1.82855,-1.18124, 2.99251,0.3318, 1.47957,-2.06334, 0.26759,-1.74884, 2.64281,-1.68871, 2.66383,-0.760279, 2.38822,-0.384402, 1.04232};
//28 pmts

  double evt0[]={-0.314177, 0.247528,-0.0993416, 0.725975,-0.995547, 0.458355,0.894218, 0.372787,-0.314164, 0.962685,-2.71497, 0.157274,0.597313, 1.10967,1.80046, 0.529725,-0.276416, 1.19796,1.61458, 0.770295,0.773416, 1.07682,-0.544141, 1.13381,-2.16031, 0.649714,-2.66067, 0.566228,-0.314144, 1.32072,-0.0512238, 1.33359,-1.753, 0.753371,-0.29655, 1.47526,-1.96468, 0.924408,-1.51345, 1.16361,2.93748, 0.746485,0.73273, 1.57831,-1.43961, 1.23087,0.189308, 1.66604,-2.07233, 1.04886,2.4291, 1.1338,-1.24959, 0.875493,-0.977657, 1.63599,0.126103, 1.94899,0.714793, 1.70963,2.52324, 1.24619,-0.415723, 2.14957,0.162816, 2.09622,-0.14128, 2.13901,0.522219, 2.084,1.26826, 2.14314,-3.0723, 1.57903,-1.0154, 2.33399,2.66728, 1.66533,-2.02677, 1.91156,2.98899, 1.72616,1.5708, 2.17891,-0.789544, 2.51512,1.82828, 2.14028,-0.59416, 2.58819,-2.16857, 2.1486,1.64028, 2.61166,-2.13035, 2.26899,1.16438, 2.80536,-2.74383, 2.76785,2.29098, 2.80294};
  int evtNum = sizeof(evt0)/sizeof(double);
  int kk = 0, jj=0;
  int npmt = 0;
  if (evtNum%2 == 0) npmt = evtNum/2;
  else npmt = evtNum/2 +1;
  double flm = 0;
  double s0=0, s1=0, s2=0, s3=0;
  for(int l = 0; l < 4; l++)
  {
    for(int m = -l;m<=l;m++) // !! m>=0
    {
        //cout<<l<<", "<<m<<endl;
        TF1 *Ylm = new TF1("Legendre", "ROOT::Math::sph_legendre([0],[1],x)", -1, 1);
        Ylm->SetParameters( l, abs(m) );
        for(int i = 0;i<npmt;i++) {
          double theta = evt0[kk]; kk = 2*i;
          double phi = evt0[jj]; jj = 2*i+1;
          double ylm = Ylm->Eval(theta);
          if(m>0) ylm = ylm*cos(m*phi);
          if(m<0) ylm = ylm*sin(abs(m)*phi);
          flm = flm + sin(theta)*ylm*1;
        }
        if(l == 0) s0 = s0+flm*flm;
        if(l == 1) s1 = s1+flm*flm;
        if(l == 2) s2 = s2+flm*flm;
        if(l == 3) s3 = s3+flm*flm; 
        
    }
  }
  cout<<"npmt "<<i<<" "<<flm<<" "<<s0/i<<" "<<s1/i<<" "<<s2/i<<" "<<s3/i<<endl;
}
