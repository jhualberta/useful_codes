#include <vector>
void solarChPdf()
{
  double waterpdf[]={0.0140342, 0.0141184, 0.0143289, 0.0145342, 0.0148263, 0.0151684, 0.0152658, 0.0150974, 0.0156105, 0.0155079, 0.0157974, 0.0162526, 0.0168789, 0.0167263, 0.0168289, 0.0175921, 0.0176895, 0.0181237, 0.0182763, 0.0186289, 0.0186, 0.0193868, 0.0194711, 0.0200395, 0.0198184, 0.0208079, 0.0209, 0.0214684, 0.0218921, 0.0224632, 0.0230737, 0.0233053, 0.0238079, 0.0241263, 0.0246211, 0.0248105, 0.0259684, 0.0259658, 0.0266605, 0.0274895, 0.0280605, 0.0284184, 0.0289421, 0.0294237, 0.0300816, 0.0305421, 0.0313974, 0.0316184, 0.0328868, 0.0332158, 0.0333158, 0.0349079, 0.0346316, 0.0361368, 0.0371474, 0.0369553, 0.0383737, 0.0394105, 0.0402605, 0.0404658, 0.0409132, 0.0419579, 0.0429605, 0.0440158, 0.0450132, 0.0461395, 0.0470763, 0.0479711, 0.0487868, 0.0500579, 0.0512711, 0.0515763, 0.0533842, 0.0542184, 0.0553368, 0.0565789, 0.0570026, 0.0590368, 0.0604763, 0.0614895, 0.0627368, 0.0642579, 0.0665026, 0.0664237, 0.0681132, 0.0696211, 0.0720237, 0.0737974, 0.0745342, 0.0763921, 0.0784211, 0.0802868, 0.0812921, 0.0829921, 0.0848526, 0.0870789, 0.0892105, 0.0913632, 0.0935263, 0.0953184, 0.0971263, 0.0994947, 0.101568, 0.10505, 0.106989, 0.108747, 0.112716, 0.115024, 0.117761, 0.120861, 0.122789, 0.126653, 0.129711, 0.133795, 0.137197, 0.140158, 0.143882, 0.147392, 0.150787, 0.153826, 0.1595, 0.162261, 0.166605, 0.171576, 0.174908, 0.180482, 0.186182, 0.191463, 0.196187, 0.201682, 0.206774, 0.213574, 0.218197, 0.224616, 0.231679, 0.239163, 0.245353, 0.253068, 0.260413, 0.268808, 0.275805, 0.284239, 0.293247, 0.302471, 0.310608, 0.321092, 0.332032, 0.344274, 0.355942, 0.367397, 0.380934, 0.392561, 0.407068, 0.421218, 0.438945, 0.454755, 0.473458, 0.490255, 0.508824, 0.529003, 0.552076, 0.572608, 0.599029, 0.625458, 0.654121, 0.684313, 0.717371, 0.74935, 0.792632, 0.829653, 0.877292, 0.92525, 0.970547, 0.996903, 1.00237, 0.987555, 0.947292, 0.907053, 0.869334, 0.841003, 0.809482, 0.776424, 0.750021, 0.724474, 0.700124, 0.674739, 0.650079, 0.629787, 0.611989, 0.589055, 0.569929, 0.550379, 0.532632, 0.515161, 0.496537, 0.482984, 0.466082, 0.450729, 0.437766, 0.42511};


// this spectrum only shift the peak
  double scintpdf[]={0.0150974, 0.0156105, 0.0155079, 0.0157974, 0.0162526, 0.0168789, 0.0167263, 0.0168289, 0.0175921, 0.0176895, 0.0181237, 0.0182763, 0.0186289, 0.0186, 0.0193868, 0.0194711, 0.0200395, 0.0198184, 0.0208079, 0.0209, 0.0214684, 0.0218921, 0.0224632, 0.0230737, 0.0233053, 0.0238079, 0.0241263, 0.0246211, 0.0248105, 0.0259684, 0.0259658, 0.0266605, 0.0274895, 0.0280605, 0.0284184, 0.0289421, 0.0294237, 0.0300816, 0.0305421, 0.0313974, 0.0316184, 0.0328868, 0.0332158, 0.0333158, 0.0349079, 0.0346316, 0.0361368, 0.0371474, 0.0369553, 0.0383737, 0.0394105, 0.0402605, 0.0404658, 0.0409132, 0.0419579, 0.0429605, 0.0440158, 0.0450132, 0.0461395, 0.0470763, 0.0479711, 0.0487868, 0.0500579, 0.0512711, 0.0515763, 0.0533842, 0.0542184, 0.0553368, 0.0565789, 0.0570026, 0.0590368, 0.0604763, 0.0614895, 0.0627368, 0.0642579, 0.0665026, 0.0664237, 0.0681132, 0.0696211, 0.0720237, 0.0737974, 0.0745342, 0.0763921, 0.0784211, 0.0802868, 0.0812921, 0.0829921, 0.0848526, 0.0870789, 0.0892105, 0.0913632, 0.0935263, 0.0953184, 0.0971263, 0.0994947, 0.101568, 0.10505, 0.106989, 0.108747, 0.112716, 0.115024, 0.117761, 0.120861, 0.122789, 0.126653, 0.129711, 0.133795, 0.137197, 0.140158, 0.143882, 0.147392, 0.150787, 0.153826, 0.1595, 0.162261, 0.166605, 0.171576, 0.174908, 0.180482, 0.186182, 0.191463, 0.196187, 0.201682, 0.206774, 0.213574, 0.218197, 0.224616, 0.231679, 0.239163, 0.245353, 0.253068, 0.260413, 0.268808, 0.275805, 0.284239, 0.293247, 0.302471, 0.310608, 0.321092, 0.332032, 0.344274, 0.355942, 0.367397, 0.380934, 0.392561, 0.407068, 0.421218, 0.438945, 0.454755, 0.473458, 0.490255, 0.508824, 0.529003, 0.552076, 0.572608, 0.599029, 0.625458, 0.654121, 0.684313, 0.717371, 0.74935, 0.792632, 0.829653, 0.877292, 0.92525, 0.970547, 0.996903, 1.00237, 0.987555, 0.947292, 0.907053, 0.869334, 0.841003, 0.809482, 0.776424, 0.750021, 0.724474, 0.700124, 0.674739, 0.650079, 0.629787, 0.611989, 0.589055, 0.569929, 0.550379, 0.532632, 0.515161, 0.496537, 0.482984, 0.466082, 0.450729, 0.437766, 0.425111, 0.40948, 0.397057, 0.385012, 0.373331, 0.362005, 0.351023, 0.340374};

  TH1F *hwaterpdf = new TH1F("hwaterpdf","water pdf",200,-1,1);

  TH1F *hscintpdf = new TH1F("hscintpdf","scint pdf",200,-1,1);

  TH1F *hflatpdf = new TH1F("hflatpdf","flat pdf",200,-1,1);

  for(int i =0;i<200;i++)
  { 
    hwaterpdf->SetBinContent(i+1,waterpdf[i]);
    hscintpdf->SetBinContent(i+1,scintpdf[i]*0.65+0.35);
    //hscintpdf->SetBinContent(i+1,scintpdf[i]);
    hflatpdf->SetBinContent(i+1,1);
  }

  hscintpdf->Scale(hwaterpdf->GetMaximum()/hscintpdf->GetMaximum());
  hflatpdf->Scale(hscintpdf->Integral()/hflatpdf->Integral());
  hflatpdf->SetLineColor(kGreen+1);
  // peak + flat distribution
  for(int i=0;i<200;i++)
  {
    cout<<hscintpdf->GetBinContent(i+1)<<", ";
  }
  cout<<endl;

  for(int i=0;i<200;i++)
  {
    cout<<hflatpdf->GetBinContent(i+1)<<", ";
  }
  cout<<endl;

  double scale = hwaterpdf->GetMaximum();//Integral();
  hwaterpdf->SetLineColor(kBlue);
  hscintpdf->SetLineColor(kRed);
//  hwaterpdf->Rebin(4.0);
  TFile *f = new TFile("ResolRat_MergedRun10_TeLoadedB8_Solar_Nue.root");
  vector<TH1F*> hcosTheta_cutwin1;
  const int plotNum = 11;
  for(int i =0;i<plotNum;i++)
  {
    TH1F *htemp = new TH1F("hcosTheta_cutwin3","cut window 3",200,-1,1);
    hcosTheta_cutwin1.push_back(htemp);
    delete htemp;
  }

  for(int i =0;i<plotNum;i++)
  {
    hcosTheta_cutwin1[i] = (TH1F*)f->Get(Form("hcosTheta_cutwin3_%u",i));
  }
//
  for(int i =0;i<plotNum;i++)
  {
    hcosTheta_cutwin1[i]->Scale(scale/hcosTheta_cutwin1[i]->GetMaximum());//Integral());
//    hcosTheta_cutwin1[i]->Rebin(4.0);
  }
//
   hwaterpdf->Draw();hscintpdf->Draw("same");hflatpdf->Draw("same");

   hcosTheta_cutwin1[0]->Draw("same");
/*
    const int n = 200;
    Double_t res[n], x[n];
    hcosTheta_cutwin1[0]->Chi2Test(hwaterpdf,"UW P",res);

    for (Int_t i=0; i<n; i++) x[i]= -1.+i*200./200.;
    TGraph *resgr = new TGraph(n,x,res);
    resgr->GetXaxis()->SetRangeUser(4,16);
    resgr->GetYaxis()->SetRangeUser(-3.5,3.5);
    resgr->GetYaxis()->SetTitle("Normalized Residuals");
    resgr->SetMarkerStyle(21);
    resgr->SetMarkerColor(2);
    resgr->SetMarkerSize(.9);
    resgr->SetTitle("Normalized Residuals");

  //Quantile-Quantile plot
    TF1 *fun = new TF1("fun","TMath::Gaus(x,0,1)",-10,10);
    TGraphQQ *qqplot = new TGraphQQ(n,res,fun);
    qqplot->SetMarkerStyle(20);
    qqplot->SetMarkerColor(2);
    qqplot->SetMarkerSize(.9);
    qqplot->SetTitle("Q-Q plot of Normalized Residuals");

    //create Canvas
   TCanvas *c1 = new TCanvas("c1","Chistat Plot",10,10,700,600);
   c1->SetFillColor(33);
   c1->Divide(2,2);

// Draw Histogramms and Graphs
   c1->cd(1);
   gPad->SetFrameFillColor(21);
   hcosTheta_cutwin1[0]->SetMarkerColor(4);
   hcosTheta_cutwin1[0]->SetMarkerStyle(20);
   hcosTheta_cutwin1[0]->Draw("E");

   c1->cd(2);
   gPad->SetFrameFillColor(21);
   hwaterpdf->Draw("");
   hwaterpdf->SetMarkerColor(4);
   hwaterpdf->SetMarkerStyle(20);
 
   c1->cd(3);
   gPad->SetFrameFillColor(21);
   gPad->SetGridy();
   resgr->Draw("APL");
 
   c1->cd(4);
   gPad->SetFrameFillColor(21);
   qqplot->Draw("AP");
 
   c1->cd(0);
 
   c1->Update();
*/

}
