{
  //For WLS study
  gROOT->Reset();
  //gStyle->SetOptStat(0);
  TFile *f = new TFile("WLS_process_5MeV.root");
  TH1F *hTimeDiff = (TH1F*)f->Get("timeDiff");
  hTimeDiff->SetTitle("Time distribution for Cerenkov photon getting absorbed and reemitted");
  TH1F *hCerenkovAngle = (TH1F*)f->Get("CerenkovAngle");
 double arrayPDF[1600] ={188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,188.038203657,508.10410563, 515.20821126, 522.31231689, 596.6299824, 670.9476479 , 745.2653134, 819.5829789, 878.93155282, 893.37285199, 907.81415116, 922.25545033, 936.6967495, 951.13804867, 965.57934784, 980.02064701, 994.46194619, 1008.90324536, 1023.34454453,1037.7858437, 1052.22714287,1246.0, 2116.0,3451.0 , 5565.0, 8753.0, 13547.0, 20094.0, 28914.0, 39592.0, 53041.0, 68935.0, 86863.0, 108118.0, 129300.0, 150250.0, 168922.0, 184452.0, 198304.0, 205884.0, 212686.0, 212849.0, 210642.0, 203420.0, 192081.0, 178262.0, 161864.0, 144285.0, 126034.0, 108278.0, 91012.0, 75672.0, 61835.0, 50112.0, 40023.0, 31871.0, 25283.0, 19988.0, 15794.0, 12680.0, 10464.0, 8641.0, 7028.0, 6277.0, 5313.0, 4687.0, 4268.0, 3793.0, 3540.0, 3131.0, 2963.0, 2854.0, 2624.0, 2509.0, 2327.0, 2316.0, 2245.0, 2166.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0, 2151.0};
  TH1F *hPDF = new TH1F("hPDF","PMTresponse PDF",1600,-100,300);
  TCanvas *c1 = new TCanvas("c1","convolution",400,300);
  c1->Divide(2,2) ;
  
  c1->cd(1);
  hTimeDiff->Draw();
  c1->cd(2);
  
  for(int i=0; i< 1600; i++ ){ hPDF->SetBinContent(i,arrayPDF[i]) ; }
  
  hPDF->Draw();
  c1->cd(3);
  
  int nBinsH1=1600;
  int nBinsH2=1600 ;
  int nBinstemp = nBinsH1+nBinsH2-1;

  double binWidth =1.0;

  TH1D temp("TEMP","temp",nBinstemp,0,(double)nBinstemp*binWidth);
  
  TH1D tempG("TEMPG","tempG",nBinstemp,0,(double)nBinstemp*binWidth);

  TH1D tempP("TEMPP","tempP",nBinstemp,0,(double)nBinstemp*binWidth);

  TH1D *hConvl = new TH1D("hConvl","Colvoluted distribution",1600,1,1600) ;

  //gPad->SetGrid();
  /*
  TH1F *f1=new TH1F("f1","PulseGT poissionian distribution with mean 2.0 nhits",500,1,100);

  TH1F *f2=new TH1F("f2","convoluted distribution with gamma nhits",100,1,100);
  TH1F *f2P=new TH1F("f2P","convoluted distribution with positron nhits",100,1,100);
  TH1F *f22=new TH1F("f22","convoluted distribution with antineutrino and gamma nhits",100,1,100);

  TH1F *f3=new TH1F("f3","PulseGT Trigger rate",100,1,100);
    
  for(int i=0; i< nBinsH1 ; i++){ double funV= 2.0**i*TMath::Exp(-2.0)/TMath::Factorial(i); f1->SetBinContent(i,funV);}

  for(int b=0; b< nBinsH1 ; b++){ double bincont = 1e7*(f1->GetBinContent(b)); f3->SetBinContent(b,bincont);}

  f1->SetLineColor(kRed);
  f1->GetXaxis()->SetRange(0,70);
  f1->GetXaxis()->SetTitle("Nhits");
  f1->Draw();

  c1->cd(3);
 
  gPad-> SetLogy();
   
  f3->GetXaxis()->SetRange(0,70);
  f3->GetXaxis()->SetTitle("Nhits");
  f3->GetYaxis()->SetTitle("Trigger Rate");
  f3->SetLineColor(kBlack);
  gPad->SetGrid();
  f3->Draw();

  c1->cd(4);
  */

  for(int j=1; j<=nBinsH1; j++){
    double val = hPDF->GetBinContent(j);
    for(int k=1; k<= nBinsH2; k++)
      {
	double convVal = hTimeDiff->GetBinContent(k) ;
	double t= tempG->GetBinContent(j+k-1);
	tempG->SetBinContent(j+k-1,t+val*convVal);
      }

  }

  for(int m=1; m<=nBinsH1; m++) {
    hConvl->SetBinContent(m,tempG->GetBinContent(m));
  }

  hConvl->Draw() ;

 // std::cout<< " sPDF_WLSFit : [ "<<std::endl ;
 
  for(int k=1; k< nBinsH1; k++) std::cout << hConvl->GetBinContent(k)<<", " ;
  //std::cout << std::endl ;
 
  c1->cd(4);

//  hCerenkovAngle->Draw() ;
//  std::cout <<" hCerenkovAngle->GetNbinsX() "<< hCerenkovAngle->GetNbinsX() << std::endl ;
//
// for(int kk=1; kk< hCerenkovAngle->GetNbinsX(); kk++) std::cout << hCerenkovAngle->GetBinContent(kk)<<", " ;
//
  std::cout<<std::endl ;
  
/*  f2->GetXaxis()->SetRange(0,70);
  f2->GetXaxis()->SetTitle("Nhits");
  f2->SetLineColor(kBlue);
  gPad->SetGrid();
  f2->Draw();

  c1->cd(5);

  for(int pj=1; pj<=nBinsH1; pj++){
    double valP = f1->GetBinContent(pj);
    for(int pk=1; pk<= nBinsH2; pk++)
      {
	double convVal = nhitP->GetBinContent(pk) ;
	double t= tempP->GetBinContent(pj+pk-1);
	tempP->SetBinContent(pj+pk-1,t+valP*convVal);
      }

  }

  for(int mp=1;mp<=100; mp++){
    f2P->SetBinContent(mp,tempP->GetBinContent(mp));
  }


  f2P->GetXaxis()->SetRange(0,70);
  f2P->GetXaxis()->SetTitle("Nhits");
  f2P->SetLineColor(kBlue);
  gPad->SetGrid();
  f2P->Draw();
 */
  /*  
  for(int jj=1; jj<=nBinsH1; jj++){
    double valG = f2->GetBinContent(jj);
    for(int kk=1; kk<= nBinsH2; kk++)
      {
	double convValG= nhit->GetBinContent(kk) ;
	double tG= temp->GetBinContent(jj+kk-1);
	temp->SetBinContent(jj+kk-1,tG+valG*convValG);
      }

  }


  for(int m=1;m<=100; m++){
    f22->SetBinContent(m,temp->GetBinContent(m));
  }

  f22->GetXaxis()->SetRange(0,70);
  f22->GetXaxis()->SetTitle("Nhits");
  f22->SetLineColor(kBlue);
  gPad->SetGrid();
  f22->Draw();
  
  
  Int_t biniG = nhitG->FindBin(12);
  Int_t binfG = nhitG->FindBin(70);
  Double_t integNhit = nhitG->Integral(biniG,binfG);
  cout<<" Integral of nhits above threshold in NHitG "<<integNhit<<endl ;
  */
}
