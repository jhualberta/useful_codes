#/usr/bin/python
import sys,os
import collections
import subprocess
from subprocess import *
from ROOT import *
from array import array

### all Th runs are RunType 465
runListThType465 = [28103,28105,28110,28119,28123,28132,28137,28147,28160,28164,28173,28188,28192,28193,28203,28208,28218,28222,28225,28234,28239,28248,28252,28261,28266,28275,28279,28288,28294,28295,28310,28314,28323,28325,28330,28331,28343,28348,28357,28362,28363,28372,28374,28375,28379,28381,28383,28393,28398,28409,28413,28422,28427,28436,28440,28449,28454,28464,28468,28472,28481,28486,28487,28512,28516,28525,28530,28545,28549,28565,28570,28579,28583,28593,28595,28608,28624,28632,28637,28655,28659,28660,28670,28676,28685,28689,28702,28708,28730,28734,28743,28748,28758,28763,28786,28795,28800,28809,28813,28815,28824,28829,28838,28844,28847,28849,28860,28872,28876,28889,28894,28902,28906,28914,28918,28921,28929,28933,28939,28943,28953,28961,28965,28973,28977,28985,28989,28997,29001,29010,29014,29025,29029,29037,29041,29049,29053,29067,29071,29080,29084,29085,29094,29098,29110,29114,29124,29128,29137,29141,29163,29167,29178,29182,29188,29192,29193,29197,29201,29205,29209,29213,29217,29221,29225,29233,29237,29241,29246,29250,29254,29255,29259,29263,29268,29272,29276,29280,29284,29288,29292,29296,29300,29304,29308,29309,29313,29317,29321,29325,29329,29333,29337,29341,29345,29349,29353,29357,29361,29365,29369,29373,29377,29381,29389,29393,29397,29401,29407,29411,29415,29419,29423,29427,29431,29439,29443,29447,29451,29455,29459,29463,29468,29472,29476,29480,29484,29488,29492,29493,29497,29501,29505,29509,29513,29517,29521,29525,29529,29533,29537,29538,29542,29549,29551,29555,29559,29563,29567,29571,29575,29579,29581,29582,29586,29590,29595,29597,29598,29602,29606,29610,29614,29618,29622,29626,29630,29634,29638,29642,29646,29648,29652,29658,29665,29673,29676,29691,29696,29700,29704,29708,29712,29716,29720,29724,29728,29732,29736,29740,29744,29748,29752,29759,29763,29767,29771,29775,29779,29783,29787,29791,29795,29799,29803,29807,29811,29815,29819,29823,29827,29831,29835,29842,29846,29847,29848,29851,29856,29857,29861,29869,29873,29877,29881,29883,29884,29888]

runListVac = [29892,29893,29897,29901,29905,29910,29920,29924,29925,29929,29930,29934,29938,29942,29946,29950,29954,29958,29969,29971,29972,29973,29974,29978,29984,29988,29992,29997,29998,29999,30000,30005,30016,30018,30019,30020,30021,30022,30026,30031,30033,30035,30036,30040,30044,30048,30049,30051,30052,30053,30057,30061,30062,30068,30072,30073,30074,30078,30082,30083,30084,30088,30089,30093,30097,30098,30102,30103,30107,30112,30113,30117,30121,30122,30123,30124,30125,30130,30131,30132,30133,30134,30135,30137,30141,30146,30150,30154,30158,30162,30166,30170,30176,30180,30182,30183,30192,30196,30197,30201,30205,30209,30213,30216,30217,30221,30225,30231,30239,30243,30247,30251,30256,30260,30262,30268,30272,30276,30280,30285,30289,30293,30297,30301,30306,30310,30314,30318,30322,30323,30333,30337,30338,30339,30343,30347,30351,30352,30356,30361,30365,30366,30368,30372,30376,30379,30383,30387,30388,30392,30396,30400,30417,30419,30424,30433,30437,30439,30443,30448,30452,30453,30458,30463,30467,30472,30476,30481,30485,30490,30494,30495,30500,30504,30507,30513,30518,30522,30527,30528,30532,30537,30543,30544,30549,30553,30557,30565,30567,30568,30572,30577,30581,30590,30595,30599,30604,30605,30609,30614,30618,30623,30627,30636,30642,30646,30651,30655,30658,30663,30672,30676,30681,30686,30690,30695,30699,30700,30705,30706,30707,30708,30712,30717,30721,30726,30730,30731,30732,30735,30736,30741,30742,30743,30744,30746,30747,30751,30756,30760,30765,30769,30774,30778,30779,30784,30785,30789,30794,30799,30804,30808,30813,30814,30815,30819,30824,30826,30832,30837,30841,30846,30850,30855,30858,30859,30865,30870,30876,30881,30889,30894,30898,30903,30905,30909,30916,30922,30923,30926,30929,30936,30943,30948,30953,30961,30962,30963,30964,30965,30969,30974,30978,30983,30987,30992,31002,31003,31008,31012,31016,31020,31025,31029,31034,31038,31043,31053,31057,31063,31067,31072,31076,31081,31082,31083,31084,31085,31086,31094,31099,31103,31113,31114,31118,31123,31124,31125,31130,31132,31137,31141,31146,31150,31155,31159,31161,31162,31163,31166,31170,31171,31172,31182,31186,31192,31196,31201,31205,31206,31211,31216,31224,31228,31233,31241,31246,31250,31251,31256,31260,31265,31275,31279,31284,31285,31286,31287,31291,31296,31297,31301,31302,31304,31309,31313,31318,31322,31327,31331,31334,31339,31343,31351,31355,31360,31361,31365,31370,31374,31379,31382,31386,31391,31395,31403,31405,31409,31410,31411,31416,31420,31425,31429,31435,31437,31448,31452,31458,31464,31470,31476,31480,31485,31489,31495,31499,31505,31511,31527,31528,31533,31538,31542,31547,31552,31557,31561,31573,31577,31582,31586,31591,31595,31600,31601,31602,31606,31611,31612,31613,31614,31615,31619,31622,31627,31629,31633,31634,31636,31638,31643,31647,31652,31656,31662,31666,31671,31675,31676,31681,31684,31688,31693,31697,31702,31706,31711,31715,31722,31727,31728,31729,31731,31733,31735,31737,31739,31747,31752,31757,31761,31766,31770,31775,31779,31780,31786,31794,31797,31798,31806,31809,31813,31818,31822,31827,31831,31836,31840,31844,31854,31858,31863,31871,31874,31877,31882,31886,31891,31895,31902,31908,31916,31922,31923,31930,31936,31944,31945,31947,31949,31951,31953,31955,31957,31959,31964,31970,31975,31983,31987,31992,31998,32003,32008,32022,32026,32031,32035,32042,32046,32056,32061,32065,32070,32072,32076,32082,32086,32088,32093,32097,32101,32106,32110,32115,32119,32121,32131,32139,32144,32148,32149]

runTotal = runListThType465 + runListVac

### some vac runs are RunType 465
runListVacType465 = [30040,30721,31747,30213,30209,31752,31241,30730,30731,30732,29954,30735,30736,31761,31250,31251,30553,31770,31260,30751,31779,31780,30760,30251,30898,31279,30769,31794,31923,30260,31797,31798,30217,30778,30779,30400,30133,30272,30417,31499,30789,31302,31304,31822,30799,31313,30819,31831,30808,30297,31322,31840,30306,31331,31844,31334,30314,31343,30832,31858,30323,30419,30841,31355,31871,30658,30337,30850,30339,31365,30347,30146,31374,30130,30865,32148,31895,30361,31386,30876,32026,29893,31395,31908,30216,30889,30322,30383,31409,31410,31411,29897,30392,29978,30495,31420,30909,31936,29892,31429,31922,31945,30922,32119,29901,31949,29905,30243,31957,29910,31959,31452,30943,29920,30433,31970,29924,29925,31953,31464,30953,29930,30443,30338,30162,29934,30504,29938,31987,30452,30453,29942,31480,30969,29946,31998,31489,30978,30467,29958,32008,30987,30476,31874,30485,31511,31002,31003,30494,31877,29984,32035,31012,29992,30507,31020,31533,32046,30513,31029,31542,32056,30522,30221,31038,30005,31552,32065,30532,30262,31561,30026,32076,30543,30544,31057,31886,32086,32088,31577,31067,30044,30557,31586,31291,31076,32101,30097,30057,31595,30572,30098,32110,29950,30068,30581,31094,29929,32121,30590,30078,31103,31619,31622,30599,30088,30089,32139,31118,31633,31634,31636,32149,31638,31130,30107,31132,30618,31301,31728,30627,31141,31656,30636,31150,30280,31666,30131,30132,31606,30134,30135,30137,31647,31676,30655,31170,31171,31172,31688,30154,31675,31697,31186,30676,30192,30646,30201,30372,31706,31196,30609,30117,30176,30690,31715,31205,31206,30289,30699,30700,31216,31733,30712,31737,31228,31813]
#
### all vac runs are RunTpe 481
runListVacType481 = [31233, 30379, 30726, 31757, 31246, 30225, 30741, 30742, 30231, 30744, 30746, 30747, 30196, 30239, 31265, 30756, 30247, 31786, 31275, 30765, 30813, 30256, 31284, 31285, 30774, 31287, 30093, 31327, 30268, 31370, 31806, 30707, 30784, 30785, 29974, 30276, 30049, 30794, 31159, 30285, 31827, 30804, 30293, 31318, 31836, 30301, 30814, 30815, 30651, 30623, 30964, 30310, 29969, 30824, 30826, 31339, 30318, 30141, 30061, 30837, 31351, 30743, 30102, 30333, 30846, 31016, 31360, 31361, 31766, 30343, 30858, 30859, 31882, 30351, 30352, 31256, 31379, 30356, 30062, 31382, 30365, 30366, 31391, 30368, 30881, 31854, 30577, 30376, 31403, 31916, 31405, 30894, 30663, 30387, 30388, 30903, 31416, 30905, 31930, 31775, 30396, 31425, 30923, 30916, 30183, 31944, 31435, 32106, 31437, 30926, 31951, 30929, 31955, 30158, 30936, 29988, 31964, 31458, 31099, 30948, 30437, 30439, 31470, 31983, 30448, 30961, 30962, 30963, 31476, 30965, 31992, 30458, 31485, 30974, 30463, 32003, 30166, 31495, 30472, 30424, 30992, 30481, 29971, 29972, 29973, 32022, 30490, 31975, 32031, 31008, 30527, 30500, 31527, 31528, 32042, 30855, 31448, 29997, 29998, 29999, 30000, 31025, 31538, 30717, 30518, 31034, 31547, 32061, 30983, 30016, 30018, 30019, 30020, 31286, 30022, 32072, 30537, 32131, 31053, 30031, 30033, 32082, 30035, 30036, 30549, 31063, 30083, 30205, 32093, 31582, 30048, 32097, 30051, 30052, 30565, 30567, 30568, 31081, 31082, 31083, 31084, 31085, 31086, 31600, 31601, 31602, 32115, 31072, 31297, 30072, 30073, 30074, 31611, 31612, 31613, 31614, 31615, 31296, 30082, 30595, 30084, 30870, 31809, 30053, 31113, 31114, 31627, 30604, 30605, 32144, 31123, 31124, 31125, 30614, 30103, 31643, 30021, 30112, 31137, 31652, 32070, 30705, 30121, 31043, 30123, 30124, 30125, 31662, 30642, 31155, 31902, 31947, 31671, 31161, 31162, 31163, 31818, 31166, 31146, 31681, 31684, 30150, 30113, 31693, 31182, 31309, 30672, 31891, 31629, 31702, 30528, 31192, 30681, 30170, 31863, 31505, 30686, 31711, 31201, 30180, 30182, 30695, 31722, 31211, 31727, 31729, 30706, 31591, 30708, 30197, 31557, 31735, 31224, 31731, 31739, 30122, 31573]
### runListType465 = runListThType465 + runListVacType465 

### events from livetime DB


totalEventsTh = [12024842,18310929,28785634,29677894,29566535,26471531,32767406,36879070,29194746,29708802,29262888,30067122,13278211,15054376,30387755,25264673,29021417,26987845,4664713,30050340,30759062,30115290,30005008,29965735,29288236,23421810,29629678,29888882,4855411,24691397,35021599,29964421,12636375,17772849,2948019,25967754,28556151,36198469,28892203,15074613,13679327,11270674,11789036,5936461,12330960,1267013,13229130,30780804,28149998,28891651,29271130,33396547,26200733,31766517,28272781,29098825,29703857,27910558,7582416,21456506,30014226,23969380,525554,30536415,37922984,30967312,28046288,28045544,36297466,28999352,31133962,26018138,29478168,29435354,24014974,26617796,10386785,26661839,32547665,28370793,1921969,28477365,28740359,36657079,25504713,29352225,27563166,26877859,3666458,24157316,29324789,28831134,28969284,30675972,18193272,29322865,28751952,23517606,6657051,22355118,28543571,28441818,27203770,2959576,12453017,13219087,29976808,34893726,28265647,34324776,31543372,32912958,34007389,35520351,32731472,1455922,37091311,35952860,8954858,13984262,31556713,40821841,49865859,43682773,41442102,43703786,41834729,44471078,45441162,46395621,48468794,54144175,41259119,62168097,39160447,50035206,52857841,60882047,47520807,58102468,27947904,28125147,58501586,46540457,63837960,58079916,61681811,53218316,60278304,64677875,59184631,65964928,31149288,37088770,63796320,17854243,48718591,71813441,70281351,65618627,70577215,66205537,74052531,70717806,76258053,58735838,66275501,64917549,71946451,71031366,18209715,51762576,72546666,73464054,72272181,73954104,74542033,77878194,75284178,71156462,69411017,79556156,72581826,76542811,74703476,72538,75156159,74173935,81850921,69962153,75509841,75989109,76287111,74869885,78249918,71397629,77292405,84127513,70093623,76069953,78955535,75417806,89796397,72087222,85243733,69398842,77743531,78987148,74980523,78061639,76358031,99426586,56349777,77616944,80082309,77863345,76368774,83912818,76537728,74379045,80359428,79126351,77538599,78855947,78786271,75475397,82587607,78858758,57209190,23065880,78278497,83249403,98591933,59352573,75891576,79801883,79168153,81624781,80714206,78757374,73316874,7129615,33313675,19231355,7474394,79233453,80314221,79082541,80215518,79491051,88199785,3601248,64567626,4052284,76528682,-1,34785128,88039,60827630,59772227,79814515,77482170,84393955,81378794,85840442,76960830,83650857,84122890,74537995,81360002,53316061,17744712,63411881,3790831,1743549,81919171,1878535,68355068,79804724,81165646,80546515,79613900,80687134,81997178,85521741,75129492,80827954,81265597,80755925,97961756,65227913,81178303,80816380,84113348,77897419,87604280,74042966,82498678,82571160,81365729,82464337,82508687,82275051,85738634,78112519,84302350,80982011,88121088,77992325,83859618,81886491,83555265,50192508,22472943,18523132,6154478,3775863,47549143,9491742,72808515,85004657,77042042,83570444,83288786,11706301,1090013,84189280,70206977]

livetimeTh = [33562.2,51166.7,80554.3,82929.4,82706,73977.5,91422.5,102921,82727.9,84241.9,83011.8,84856.2,37543.3,42662.2,86068.1,71545.9,81955.7,76137,13144.8,84796.8,86912.7,84832.1,84456.4,84567.6,82621.2,65775.2,82917.7,83391.6,13550.4,69157.3,97976.1,83849.4,35333.2,49740,8242.77,72731,80154.1,101548,81105.3,42269.8,38520.8,31747.3,33233.2,16737.9,34726.6,3552.17,37236.6,86581.7,79217.8,80981.9,81907.9,93353.4,73278.8,88788.7,79075,81333.6,83239.7,78085.2,21203,59867.8,83806.3,66983.8,1466.59,85700.5,107079,87512,79275,79737.2,103215,82179.1,88141.2,73621.4,83467.9,83246.2,68020.6,75458.5,29596,76061.5,92863.4,80712.5,5483.64,80960.5,81830.4,104177,72406.1,83168.9,78084.5,76079.3,10423.1,69218.3,83800.5,82275.2,82719.1,87651.6,51708.9,83852.8,82276.1,67379.8,19081.8,63646,81088.6,80787.7,77165.1,8456.76,35769.3,37971.4,82573,93710.8,65470.5,86210.3,78620.4,80621.7,82407.2,84440.6,77023.9,3398.41,84988.4,81414.4,19774.4,30846.6,67559,85397.6,102815,87869.7,82162.1,84618.4,79997.8,82715.1,83363.2,82975.5,85584.6,93035.4,70124.9,102780,63816.7,79527.4,83096.3,94120.3,72530.2,86771.9,41276.5,41280,84342.8,66392.9,89384.1,80410.2,83527,71358.1,79204.5,84187.8,75446.9,83306.6,38871.4,46077.1,77999.4,21765.6,59180.2,86647.8,84210.1,78054.8,83457.5,77850,86551.6,82243.9,88260,67253.1,75600.6,73803.5,81940.4,80560.2,20631.4,58528.2,81850.7,82684.4,81079.7,82650.9,83175.3,86581.1,83475.3,78689.9,76633.9,87609,79858.8,84071,81892.9,79.3917,82209.5,80933.9,89163.3,76062.7,81963,82344.6,82454.6,80872.1,84518.1,76973.7,83272.1,90525.1,75275.3,81583.7,84532.6,80705.1,95992.8,76902.6,90813,73849.6,82718.4,83972.4,79629.3,82799.1,80901.5,105166,59515.5,81907.5,84397.4,82047.5,80408.4,88346.7,80501.7,78166.3,84369.3,83059.1,81236.9,82555.7,82438.6,78911.9,86332.2,82228.9,59685.4,24056.6,81495.4,86629.4,102363,61659.8,78723.4,82752.2,82126.9,84585.5,83565.3,81470.5,75763.3,7369.67,34452.3,19877.7,7729.37,81943.4,82924,81638.2,82770.9,81887,90792.6,3710.77,65826.9,4129.86,77988.9,-0.998378,35564.5,89.0614,62176,61080.8,81510.8,79016,85815,82682.7,87202.1,78024.4,84717.4,85056.8,75316.1,82145.4,53843.3,17864.9,63955.2,51759.7,23806.8,83177.3,1928.53,69993.5,81768.1,83152.2,82476.2,81389.8,82383.8,83614.4,87116.6,76407.7,82135.6,82427.3,81681.6,99179.4,65981.6,81982.2,81557.7,84778.2,78334.7,88092.1,74341.4,82788.8,82763.1,81620.7,82657.7,82620.9,82420,85706.7,77997.1,84094.2,80595.8,87643.6,77556.3,83324.4,81242.5,82813.7,49743.5,22243.3,18344.9,6096.4,3739.62,47076.7,9388.44,72037.8,84124.4,76263.3,82681.5,82357.2,11574.2,1079.33,83164.9,69493.6]

totalEventsVac = [1602396,88484532,74892490,83132707,85379689,63592864,116673735,91571275,2972055,9587122,6966176,108901592,137814084,143233318,158158084,113390174,141059645,149123259,233917422,4204815,44839208,1961,230608072,143344611,174427044,699566529,146646913,434932025,2985086,2405253,447240403,137805717,673946617,8345014,18406342,187890008,856,91139407,116059632,164526062,6850502,71011203,662731784,7824027,138012760,7464711,525067762,170299770,135251450,13847378,145675820,295354,919412360,143837095,40394041,15484668,884381443,149532385,512111910,35886106,398226593,142660428,27178343,679370481,14529961,135575192,400051986,322523204,156940111,219408811,459621027,133365697,69564351,11067870,312976,16789425,657937549,1739780,832883,1570675,217296,92848,91451881,11764805,777047589,110305935,996756256,78810952,762158378,100071365,65527669,508852027,80341073,14588661,402448832,24099421,74859692,488834355,37816623,92100419,484858612,13470174,17001064,3735201,6422356,40511154,306722432,27658188,525426477,82438999,546460821,85350645,494396269,11255939,94071327,399816565,78622012,547078396,84853824,535670445,93591807,508152896,85089133,540269165,83892427,537731116,91558403,542655369,60786079,30695097,478808598,37260803,43908102,5167441,588093362,88475945,25361523,53053839,396899019,86381104,61076111,442693760,142655146,72297759,50957265,508906053,102445089,476476850,10614632,88170295,551408224,2675032,11030755,77002428,354343351,81705217,5236490,529702466,62617882,387718902,12251411,53864786,11211585,312671947,53887269,290925215,51650150,217166906,50539449,170604297,6485992,32412424,194219329,26862272,14926,6053122,197964143,30885092,26088722,165294205,28629881,164131373,1530616,28886841,157585950,6996871,20426951,2252469,142014913,3843055,29063826,155973710,27883759,32445480,124421477,29674500,6325844,123969456,28131261,141689484,27196893,152522348,20547455,7298168,102454174,27563810,123562659,5860716,23654233,5423465,103184644,29454759,23019321,125841842,24100116,132424292,25261778,2381173,444171,3874251,21178,141502836,23658856,137739015,27312987,134489907,15628514,1654501,268356,137482,8422923,73176747,72761,612562,2300365,261124,55792631,26224859,131720042,27139168,131779597,26756032,131919762,621917,26291373,16941360,140530472,21742960,132017830,30154238,129220066,22049908,20915898,98037910,22275565,23860266,2025664,127923420,25298704,130473255,26877249,129714039,26694708,25831739,226371,123504465,25271394,127905586,27291774,106150651,21302206,129491187,27044620,62886038,74066929,24461993,136286263,28624385,961340,8166719,696886,102349277,24274026,131104232,28528586,45266628,67266016,1122545,3208,29038472,23449238,123126145,26861929,129719613,28443961,123844592,9147777,953716,129829203,26673624,130494371,27024306,158688796,20560228,167009889,19806973,167927908,126045654,26878592,141203534,23088572,130689554,25932930,68354317,1560171,464005,1288811,1797935,18459090,25166980,140484922,28549339,67474344,4452290,25313725,4735356,244183,129118048,474050,23942869,144655779,25161673,129698618,26772733,4847627,10189998,820054,592840,1487927,98947080,25830856,1606005,112247,125724870,23826626,127194856,24461524,128885474,1440734,27108538,125045940,26694936,132726048,25475913,128535723,26786059,124389362,26108229,7389888,97184660,27107380,91155,109899637,26765528,124848053,1622927,658809,2323830,25292452,136235632,981850,206405,451553,25790894,130505645,31867583,107125440,26564529,129041300,5092438,23576876,147232705,25170015,107599156,26741047,127007122,769118,36111443,87424249,28939616,21209109,85870017,26830985,136699571,25180434,93890643,23000883,5363794,20989763,2216411,126324978,26416326,133763528,27635280,29316116,104995118,338846,23247886,129606125,17309370,42553386,78809090,27251908,130554913,26862724,127833697,25813016,132220999,25396858,43947050,58880918,26344193,130064842,27021001,128678478,26745266,156363041,20759013,105480147,26218456,130421314,26630061,158669449,21596761,124023416,130290,6683433,25455985,10269923,13647648,100011319,3809593,5359188,12817492,14154402,88652374,41696849,1328786,124035,12192993,13480876,117501396,26114936,171671993,17617377,128977055,26444806,129994417,9110749,17104465,12083862,104374953,26270726,129464462,26414782,145020150,28030847,114354164,24547807,41221062,22802611,26838700,712522,133609868,26999649,135958961,26796751,140136892,89143,23063873,166432567,18450559,128797730,26406984,128106122,1168883,28605141,111870604,21109620,650578,2835119,799315,102847430,27038129,126025310,26405804,134661922,24492729,127427454,6574543,7811461,88888670,24973348,-1,11814,1254249,22317022,132214685,26084544,129380088,32259511,117576482,22589408,56630634,215100,24886360,127514125,25775376,126841097,25952587,179399307,21497704,121731718,24093565,132087551,29391152,15193615,102291864,12220655,-1,107415382,26380537,124315657,37110896,65011283,26428711,96850104,25806939,129436557,27134485,124322420,790843,21262170,123803568,25887617,103893881,42347148,27619036,102766786,2778975,22377850,25960558,98686263,29438100,124271884,27062169,110556087,10551717,4925189,122090679,24307691,128146815,3590971,27979820]

livetimeVac = [1633.91,87135,73415.5,81398.1,83619,61735.2,86116.3,57897,1869.59,5889.29,4135,62352.1,78927.4,82047.5,90560.1,64884.9,80612.8,85100.1,16841.8,302.608,3225.47,45.4379,16588.7,81563.9,99162.8,50304.6,83292.6,31197.4,214.442,173.748,32047.9,77934.2,48079.6,595.313,1313.55,13393.7,19.851,6487.56,65297.7,11670.3,486.1,5040.51,46923.8,4376.94,77123.9,525.026,36918.8,11942.8,9490,977.32,81218.6,22.8917,64246.1,78976.7,2781.92,1066.77,60714.8,81035.9,34643.9,2425.28,26897.6,79842.3,16229,53007.6,9022.13,84037.7,31140.8,25106.8,96992.5,17063.5,35749.3,82359,5749.95,944.876,26.879,1461.71,58595.3,1223.83,587.608,1106.75,152.62,65.5147,64402.4,8286.52,69469.5,77944.1,89668.2,55919.5,68922.6,84043.1,7912.08,63092.4,78369.2,1854.42,51223.6,3079.07,74106.9,63179.3,4906.82,92240.3,63591.3,13603.8,17184.2,4035.81,6936.64,43622.8,41625.8,3847.63,72876.8,83990.3,75291,85885.5,67573,11230.8,93684.2,54148.5,77749.9,73608.9,83324,71633.8,91326.7,67500.2,82499.2,71356.9,80909.4,70727.3,87874.6,70906,58042.4,29239.3,62137.1,35331.2,41612.9,4894.13,75769.5,83331.4,3259.4,6812.99,50877.7,80898.8,7784.98,56315.5,18122.1,67274,6458.81,64307.4,94870.5,59949.3,1336.23,81645.9,71185.4,2547.92,10283.5,73329.4,49499.1,83008.9,791.368,83381.4,71232.8,71158.1,15426.9,70318.4,2370.95,69347.4,83312.4,77200.4,92057.3,68137.3,101415,61349.8,13977.9,71344.2,77382,61946.2,2.00352,14272.4,85360.4,75748.8,11885.1,76654.1,74866.3,79977.4,4111.82,78115.2,79959.6,19339.3,56286.3,1183.12,74679.3,2051.45,82133.8,84530.8,80008,94536.4,70289.9,87669.6,3619.28,71123.7,83925.7,82390,81744.7,89673,62394.9,21943.2,60512.7,83095,73466.6,17714.3,71308.7,3222.85,61320.3,88991.8,13770.6,75230.4,73088.6,79612.2,77065.7,7243.32,270.931,2349.43,12.8163,85115,72370.8,82933.2,83841.8,81547,47860.3,5070.23,826.497,421.752,25834.8,44492.9,43.9193,375.716,1469.93,160.438,34032.4,80918,80770.1,83923.7,80991.2,82698.8,81060.1,1917.54,81483.2,10462.3,86314.2,67413.3,81395.5,93703.2,79808,68538.6,12928.7,60676.7,13759.9,74455,1257.71,79253.2,78631.8,80863.2,83606.7,80518.4,83136.3,16053.1,140.95,76768.8,78020.6,79269.3,84146.3,65718.6,66158.1,80542.9,84624.4,39209.5,46023.8,76824.5,84658.6,88179.1,603.69,5091.48,429.794,63734.3,74614.2,81372.9,87823.2,28011.4,41776.1,692.611,1.94703,17981.1,72118.9,76340.4,82887.5,80673.3,87531.3,76816.8,28606.1,2977.54,80772.1,83359.3,81241.1,84577.8,98278.8,64160.8,103650,61862.8,104204,78113.3,83888.3,87658.8,72147.5,81111,81036.7,42511.8,958.46,285.827,812.906,1109.15,11445.6,79323.4,87384.3,89181.2,41846.7,2771.61,79299.9,2943.55,152.458,79937.5,1481.39,74587.4,89393.7,78607.3,80092,83610.9,2995.24,6313.59,507.136,367.961,920.92,60959.9,80443,4994,350.646,77146.4,74367.7,78420.3,76285.1,79436.8,4500.37,84405.3,76995.5,83069.9,81395.2,79430.2,79124.8,83539.5,76698.6,81583.3,23124.6,59849.1,84634.3,2114.66,67712.1,83773.7,76968.3,1002.28,409.173,1423.84,78992.3,84169.3,601.46,644.341,1410.32,80525.4,80490.6,99462.5,65689.5,82664.2,79432.9,15921.6,73555.5,91010.1,79320.1,66580.8,83462,78369.2,471.164,113021,54163.9,90315.6,12996.8,52805.3,83768.5,84134.2,78587,57745.2,14236.4,16847.8,65733,6928.7,77870.6,82435.4,82884.4,86504.1,18081.6,64874.9,207.861,72645.4,79948.4,54685.5,26534.2,49061.4,85829.9,80827.9,84373.9,79515,81021.1,81670,79590.1,26750.7,36232.1,82923.8,80945.7,84652.2,79400.1,83805,96558.9,65201.9,64901,81517.9,80496.4,83101.7,97836.7,67382.6,76246.5,79.1604,4124.05,79427.8,6325.44,8384.6,61972.3,2348.86,3327.93,40107.3,44308.4,55020.7,25977.8,3807.79,392.928,38037.4,42678.9,73504.2,82833.5,107163,55914.9,80321.5,84165.5,80927.9,28971.5,54452.9,7504.87,65045.6,83508.2,80784.1,83865.4,90213.2,89099.3,71294.2,78193.4,25721.3,14059.6,84816.2,438.243,82467.9,85408.7,84410.4,84903.6,87808,282.282,73262.7,104412,58517.2,80014.6,83490.3,79524.2,3700.12,90475.8,69398.5,67437.8,2075.08,9097.7,497.467,64073.8,85912.3,78824.5,83901.8,84229.7,77986.6,79835.1,20804.2,24938.8,55094.3,82220.7,-0.998378,273.974,3952.62,70696.7,82191.5,82917.5,81082.5,102239,74058.9,71811.4,35627.8,696.547,80650,80510,83353.6,80115.6,84056.1,113585,69708.4,76701.7,77842,83571.5,94897.7,48948.4,64551,39549.7,-0.998378,67139.2,85555.8,78762.8,120602,41166.3,85709.8,60965.1,82341.3,81457.1,86798.2,78647.8,2529.34,68120,77803.5,82761,65507.3,26866.8,88313.9,65050.7,8902.8,71087.5,16292.7,62217.8,93708.8,78244.2,86164,69821.1,33461,15719.3,76597.7,77509,80069.2,11394.2,88916.9]

totalEvents = totalEventsTh + totalEventsVac

## muon-corrected livetime
livetimeList = livetimeTh + livetimeVac

print len(runTotal), "runs", len(totalEvents), "eventRuns", len(livetimeList), "liveTimeRuns"

dataAll_liveTime = zip(runTotal, livetimeList)
dataAll_events = zip(runTotal, totalEvents)

array_rates = array('d')
array_runs = array('d')

array_rates481 = array('d')
array_runs481 = array('d')

bad_runs = []
odd_runs = []

badRun481 = []
badRun465 = []

nRuns = len(runTotal)
for i in range(nRuns):
    run = runTotal[i]
    counts = totalEvents[i]
    if counts<1:
        print "wrong run !!!! omit!!!", run
        bad_runs.append(run)
        # continue
    time = livetimeList[i]
    # print time, counts
    rates = counts/time
    if rates<100:
        print "odd run rates !!!!!!", run, rates
        odd_runs.append(run)
        if run<29888:
            print "this odd run is Th source!!!", run
   

    if run in runListVacType481 and rates<100:
        badRun481.append(run)

    if run in runListVacType465 and rates<100:
        badRun465.append(run)
    if run in runListThType465 and rates<100:
        badRun465.append(run)    
    if run in runListVacType465 and rates>6000:
        badRun465.append(run)

#    array_rates.append(rates)
#    array_runs.append(run)

    if run in runListVacType481:
       array_rates481.append(rates)
       array_runs481.append(run)
    else: 
       array_rates.append(rates)
       array_runs.append(run) 



print nRuns, "RunType465 runs, livetime = ", sum(livetimeList)/3600/24, "days"
print "bad runs with wrong run time, serious" 
print list(set(bad_runs))
print "odd runs with wrong rates"
print list(set(odd_runs))

print "bad run 465", badRun465
print "bad run 481", badRun481


nRun481 = len(runListVacType481)

gRates = TGraph(nRuns - nRun481, array_runs, array_rates)
gRates.SetLineColor( 2 )
gRates.SetLineWidth( 3 )
gRates.SetMarkerColor( 2 )
gRates.SetMarkerStyle( 21 )
gRates.SetTitle( 'Total runs' )
gRates.GetXaxis().SetTitle( 'run number' )
gRates.GetYaxis().SetTitle( 'counts/sec' )
gRates.Draw( 'AP' )

gRates481 = TGraph(nRun481, array_runs481, array_rates481)
gRates481.SetLineColor( 4 )
gRates481.SetLineWidth( 3 )
gRates481.SetMarkerColor( 4 )
gRates481.SetMarkerStyle( 20 )
gRates481.SetTitle( 'runTpye 481' )
gRates481.GetXaxis().SetTitle( 'run number' )
gRates481.GetYaxis().SetTitle( 'counts/sec' )
gRates481.Draw( 'P' )

raw_input()
