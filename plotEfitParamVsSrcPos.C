{
  // 83 internal runs
  double srcPos[][3]= {{-186,254,-5501.2},{-186,254,-4999.899},{-186,254,-4500.2},{-186,254,-4001},{-186,254,-3501.399},{-186,254,-2999.7},{-186,254,-2500.399},{-186,254,-1998.499},{-186,254,-1499.5},{-186,254,-1000.099},{-186,254,-499.6},{-186,254,0.401},{-186,254,500.8},{-186,254,1000.3},{-186,254,1500.9},{-186,254,2000.001},{-186,254,2500.3},{-186,254,3000.3},{-186,254,3500.9},{-186,254,4000.5},{-186,254,4500.4},{-185.037,247.24,4973.567},{-5.995,-0.201,-1.107},{-7.761,-998.068,0.159},{-7.084,-2000.578,-0.716},{-5.491,-2998.017,-4.196},{-3.774,-3992.167,-7.374},{-1.624,-4999.882,-12.012},{-1.745,5002.057,-9.897},{-3.967,3973.021,-7.359},{-5.984,2980.035,-3.441},{-7.952,1986.669,-1.714},{-9.242,994.183,0.553},{-9.867,496.858,0.269},{-8.414,1494.71,0.634},{-6.835,2487.539,-1.126},{-4.949,3496.338,-5.971},{-2.539,4505.371,-7.453},{-7.711,-501.268,0.126},{-7.534,-1494.927,-0.096},{-6.349,-2487.912,-1.434},{-4.366,-3475.769,-6.019},{-2.799,-4498.62,-10.213},{-1.898,-4874.53,-11.077},{-5.283,-0.209,-1.057},{-4999.043,2.46,-9.899},{-4002.525,5.269,-7.364},{-3004.229,8.101,-2.54},{-2000.155,10.637,-0.361},{-992.994,11.641,0.024},{998.133,10.897,-0.044},{2011.103,9.874,0.057},{4003.323,4.378,-5.974},{5004.868,2.262,-7.547},{4503.445,3.278,-7},{-4489.301,3.918,-10.545},{3511.147,5.742,-2.578},{2502.805,8.681,-2.803},{-3476.709,6.643,-4.886},{-186,254,5500.9},{-186,254,5999.8},{-5.399,1991.04,1988.97},{-9.92,2776.47,-2839.41},{-10.44,3227.32,-3324.9},{-8.377,-2832.33,-2839.69},{-9.284,-3137.21,-3212.18},{-4.719,-2099.25,2110.71},{-8.765,996.891,0.172},{-7.518,1990.663,-0.445},{-7.794,-997.865,0.155},{-7.083,-1990.651,-0.744},{3003.718,7.258,-0.69},{2091.016,6.312,2099.444},{2824.56,13.507,-2840.13},{3245.74,13.681,-3264.76},{-3250.29,13.438,-3264.7},{-2834.05,13.893,-2839.43},{-2109.28,6.613,2098.57},{-2771.9,16.196,-4773.96},{2771.1,15.596,-4773.27},{-121.599,81.021,6496.04},{-123.099,126.177,6997.52},{-124.4,153.386,7499.79}};

  double eResol_data[] = {0.37381288,0.391143,0.375003,0.344165,0.388573,0.393827,0.414584,0.400423,0.40572452,0.354199,0.362563,0.3744521,0.355808,0.351025,0.364512,0.3517,0.397329,0.342702,0.381783,0.382724,0.376302,0.407561,0.3471,0.372854,0.370885,0.35599,0.377669,0.384664,0.36663,0.343601,0.355674,0.349515,0.365738,0.374469,0.369451,0.347424,0.323114,0.363379,0.366498,0.372443,0.356171,0.355019,0.360499,0.3905051,0.375972,0.333381,0.349245,0.360659,0.363001,0.354748,0.390924,0.381589,0.363843,0.387965,0.38355,0.373588,0.382608,0.373571,0.355238,0.45285396,0.51563933,0.351283,0.354871,0.369797,0.357283,0.350051,0.355739,0.36494694,0.36136572,0.39130047,0.37140762,0.36582272,0.34812866,0.37086,0.37341,0.35696,0.36544,0.35502042,0.38885,0.37672,0.53580176,0.40097517,0.49951243};

  double Ndata = sizeof(eResol_data)/sizeof(double);
//  cout<<Ndata<<endl;

  double eResolErr_data[] ={0.03245396,0.0292843,0.0321646,0.0198372,0.0240066,0.0249599,0.0273566,0.026099,0.02437003,0.0231915,0.0242018,0.02566552,0.0220926,0.0245444,0.019146,0.0274124,0.0297726,0.0248322,0.0270325,0.0292955,0.0313047,0.0423629,0.0203466,0.021197,0.0240687,0.023095,0.0248906,0.0267583,0.0260809,0.0221441,0.0209924,0.0209909,0.0233708,0.0245715,0.0232896,0.0224779,0.02165,0.0215108,0.0181631,0.0218416,0.0202478,0.021789,0.0229679,0.01464778,0.0136561,0.0267507,0.0253287,0.0253743,0.0238454,0.0256575,0.0279027,0.0270189,0.0256774,0.0295219,0.0278448,0.0171234,0.0181318,0.0183524,0.039743,0.044946,0.31681576,0.0222249,0.0231786,0.0235462,0.0216977,0.02239,0.0219749,0.02226641,0.02145557,0.02390582,0.02248786,0.02580517,0.02023975,0.02134,0.02119,0.02103,0.02210,0.01761447,0.04013,0.03859,0.07489693,0.02732918,0.01625689};

  double eResol_mc[] = {0.38815269,0.40233131,0.341346,0.377104,0.358272,0.37247,0.390216,0.389174,0.38457266,0.367993,0.359853,0.3819383,0.381345,0.367957,0.365028,0.363852,0.362392,0.375685,0.38538,0.388817,0.377788,0.4116052,0.388902,0.378581,0.376308,0.37553,0.362704,0.391339,0.384029,0.364306,0.34939,0.369054,0.369967,0.367519,0.363062,0.370465,0.341954,0.366632,0.377747,0.364985,0.38857,0.355352,0.38055,0.38168133,0.358725,0.378637,0.342841,0.342841,0.364754,0.374562,0.36727,0.364892,0.353639,0.378812,0.379848,0.350817,0.381506,0.367595,0.348945,0.4278263,0.55192563,0.366976,0.354155,0.370185,0.356972,0.357828,0.35897,0.37816236,0.37786851,0.36933621,0.37484337,0.36499584,0.35220589,0.37091,0.37005,0.36270,0.37112,0.35607,0.40611,0.37745,0.45761678,0.46000412,0.67457563};

 double eResolErr_mc[] ={0.01855596,0.0164423,0.0125887,0.0137514,0.014182,0.0148483,0.0139921,0.0155153,0.01523191,0.0145565,0.0140833,0.01513705,0.0150452,0.0144886,0.0144368,0.0143319,0.0142574,0.0149611,0.0154031,0.0149304,0.0146926,0.01794182,0.0154821,0.0149593,0.0149662,0.0148061,0.0145569,0.0182182,0.0176994,0.0144416,0.0137171,0.0145754,0.014558,0.0146222,0.0141847,0.0145996,0.0134536,0.0149777,0.0150723,0.0143271,0.0155022,0.0140003,0.0156683,0.0159517,0.0141376,0.0174067,0.0136046,0.0136046,0.0142921,0.0148424,0.0144578,0.0142576,0.0139824,0.0175391,0.0155007,0.0143714,0.0150737,0.0144831,0.0136545,0.02892892,0.07293966,0.0144955,0.014113,0.0139133,0.0129117,0.0134086,0.0142,0.0149435,0.01476848,0.01461785,0.01494143,0.01451458,0.01387471,0.01339,0.01398,0.01365,0.01348,0.01408,0.02977,0.02697,0.02897309,0.02854232,0.08501489};

 double eScale_data[] = {-0.00850923,0.00379862,0.00311209,0.0194087,0.0158344,0.0144671,0.0130418,0.0144884,0.01024954,0.0213933,0.0199878,0.02606264,0.0310084,0.0329707,0.0278325,0.0329858,0.020778,0.0325535,0.0240465,0.0334336,0.0350485,0.0201872,0.0284599,0.017601,0.0224652,0.0213677,0.0179721,0.0103644,0.0136717,0.0304108,0.0211016,0.0246693,0.0228508,0.0217336,0.0249392,0.0233278,0.028585,0.0133878,0.0279436,0.021961,0.0246112,0.0256703,0.0176708,0.0119026,0.02341,0.0138176,0.0203802,0.0204256,0.0208335,0.0240214,0.0221293,0.0132977,0.0135154,0.00116543,0.0142807,0.0113655,0.0175455,0.0200273,0.0309978,0.0479155,0.08526404,0.0265759,0.0139781,0.00172691,0.013613,0.0183665,0.0279384,0.02558239,0.01954431,0.01577978,0.01461651,0.01891265,0.02097345,0.01580,0.00230,0.01801,0.01347,0.02722416,0.01842,0.01976,0.78488374,0.85975611,0.78488374};

 double eScaleErr_data[] = {0.0089768,0.00894642,0.00997922,0.00605121,0.00736757,0.007679,0.00833566,0.00794572,0.00672103,0.00691033,0.00726711,0.00747568,0.00636456,0.00691426,0.00544794,0.00762537,0.00877545,0.00700937,0.00799552,0.00806891,0.00862348,0.0122732,0.00590683,0.00648072,0.00704626,0.00691966,0.00758863,0.00758581,0.00826545,0.00631372,0.00631887,0.0062646,0.00679942,0.00732889,0.00671105,0.00676596,0.00616118,0.00682797,0.00531518,0.00643429,0.00596841,0.00640596,0.00711591,0.00413207,0.00401132,0.00861148,0.00778014,0.0076715,0.00723511,0.00757552,0.00822024,0.00839576,0.00802173,0.00893863,0.00868991,0.00497019,0.00545189,0.0054707,0.0110741,0.01360406,0.0003766,0.00639075,0.00714592,0.00721936,0.0067539,0.00694191,0.0062814,0.00635358,0.00644683,0.00729606,0.00682849,0.00772018,0.00602148,0.00649,0.00654,0.00647,0.00686,0.00510202,0.01182,0.01161,0.05521549,0.01735566,0.00754028};

 double eScale_mc[] = {-0.00948242,0.00152404,0.0104666,0.0081378,0.0158331,0.0154595,0.0105939,0.01292,0.01689606,0.0202889,0.0242095,0.02773002,0.0288556,0.0270791,0.0246827,0.0261211,0.028798,0.0285548,0.0330136,0.0395177,0.0486729,0.04397922,0.0239383,0.0259859,0.0168333,0.0170351,0.0245119,0.0179752,0.0174612,0.0276537,0.0225484,0.021349,0.025401,0.0262342,0.0241051,0.0255017,0.0310592,0.0222984,0.0259585,0.0226528,0.0187661,0.028635,0.0196281,0.01962061,0.0310538,0.0152104,0.0246714,0.0246714,0.023144,0.0246675,0.0252721,0.0226914,0.0273024,0.0149733,0.0231855,0.0228662,0.0190912,0.0225927,0.0263604,0.03952419,0.09589847,0.0264417,0.0150079,0.00278319,0.0103249,0.0111086,0.0257757,0.02141412,0.01834116,0.02608015,0.02231182,0.01874493,0.02980645,0.01208,0.00508,0.00279,0.00878,0.02426,0.03067,0.02950,0.40710331,0.47260441,0.60763032};

 double eScaleErr_mc[] ={0.00517079,0.00488789,0.00375009,0.00401559,0.00437906,0.00460485,0.00404073,0.00484353,0.00456451,0.00430901,0.0041395,0.00431525,0.00430687,0.00417727,0.00421452,0.00416823,0.00410448,0.00425129,0.0042376,0.00502885,0.00477228,0.00571117,0.0045113,0.00436688,0.0045696,0.00457434,0.00426084,0.0054412,0.00536152,0.00411801,0.00412509,0.00432805,0.00418128,0.00421192,0.00416997,0.00425608,0.00386215,0.00446976,0.0043549,0.00427887,0.00458255,0.00397944,0.00470914,0.00472974,0.00402302,0.00540319,0.00401098,0.00401098,0.00424364,0.00435294,0.00421931,0.00423763,0.00404833,0.00534933,0.00457637,0.00429641,0.00453402,0.00424286,0.00398868,0.00951394,0.00001229,0.00419493,0.00438406,0.0042772,0.00374822,0.00390959,0.00411614,0.00441004,0.00448855,0.00424266,0.00439303,0.00439511,0.00394176,0.00385,0.00423,0.00418,0.00395,0.00409,0.00820,0.00759,0.0106611,0.01125729,0.02487767};

 const int N = 80;
 double srcRho[N];
 double srcZ[N]; //no 3 neck data
 double Eresol_data[N];
 double Eresol_mc[N];
 double EresolErr_data[N];
 double EresolErr_mc[N];

 double Escale_data[N];
 double Escale_mc[N];
 double EscaleErr_data[N];
 double EscaleErr_mc[N];

 double dumy_xErr[N];
 double npoints = 0;
 for(int i = 0;i<N;i++)
 {
    srcRho[i] = sqrt(srcPos[i][0]*srcPos[i][0]+srcPos[i][1]*srcPos[i][1]+srcPos[i][2]*srcPos[i][2]);
    if(srcRho[i]<6000) { //cout<<srcPos[i][0]<<","<<srcPos[i][1]<<","<<srcPos[i][2]<<endl;
      srcZ[i]   = srcPos[i][2];
      Eresol_data[i] = eResol_data[i];
      Eresol_mc[i] = eResol_mc[i];
      EresolErr_data[i] = eResolErr_data[i];
      EresolErr_mc[i] = eResolErr_mc[i];
      if(Eresol_data[i]<0.3) cout<<"bad scale "<<srcPos[i][0]<<","<<srcPos[i][1]<<","<<srcPos[i][2]<<endl;
      if(EresolErr_data[i]>0.05) cout<<"bad error "<<srcPos[i][0]<<","<<srcPos[i][1]<<","<<srcPos[i][2]<<endl;
      Escale_data[i] = eScale_data[i];
      Escale_mc[i] = eScale_mc[i];
      EscaleErr_data[i] = eScaleErr_data[i];
      EscaleErr_mc[i] = eScaleErr_mc[i];
      dumy_xErr[i] = 0;
      npoints++;
    }
 }
  TCanvas *c1 = new TCanvas("c1", "E resol", 800,600);
  TGraphErrors *g1 = new TGraphErrors(npoints, srcRho, Eresol_data, dumy_xErr, EresolErr_data);
  g1->GetXaxis()->SetRangeUser(0,5900);
  g1->GetYaxis()->SetRangeUser(0,0.8);
  g1->GetXaxis()->SetTitle("Source radius [mm]");
  g1->GetYaxis()->SetTitle("b [#sqrt{MeV}]");
  g1->SetMarkerStyle(24);
  g1->SetMarkerColor(kRed);
  g1->Draw("AP");

  TGraphErrors *g2 = new TGraphErrors(npoints, srcRho, Eresol_mc, dumy_xErr, EresolErr_mc);
  g2->SetMarkerStyle(25);
  g2->SetMarkerColor(kBlue);
  g2->Draw("P");

  TCanvas *c2 = new TCanvas("c2", "E scale", 800,600);
  TGraphErrors *g3 = new TGraphErrors(npoints, srcRho, Escale_data, dumy_xErr, EscaleErr_data);
  g3->GetXaxis()->SetRangeUser(0,5900);
  g3->GetYaxis()->SetRangeUser(-0.06,0.10);
  g3->GetXaxis()->SetTitle("Source radius [mm]");
  g3->GetYaxis()->SetTitle("#delta_{E}");
  g3->SetMarkerStyle(24);
  g3->SetMarkerColor(kRed);
  g3->Draw("AP");

  TGraphErrors *g4 = new TGraphErrors(npoints, srcRho, Escale_mc, dumy_xErr, EscaleErr_mc);
  g4->SetMarkerStyle(25);
  g4->SetMarkerColor(kBlue);
  g4->Draw("P");



}
